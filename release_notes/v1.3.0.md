# v1.3.0 - Instant Optimization & Multi-Interface Support

**Major Overhaul**: Removed speedtests entirely in favor of instant Link Statistics. Simpler, faster, and always accurate.

## New Features

### 1. Instant Link Statistics (No More Speedtests!)
- **Removed**: `speedtest-cli`, Tele2, and Cloudflare bandwidth tests
- **Added**: Instant bandwidth detection using `iw` (Wi-Fi) and `ethtool` (Ethernet)
- **Benefits**:
    - **Instant**: Link speed is detected in milliseconds, not 30-120 seconds
    - **Accurate**: Always reflects current link quality (adapts if you move closer/farther from router)
    - **Offline**: Works without internet connectivity
    - **No false negatives**: Speedtests could fail for many reasons (server down, ISP throttling, etc.)

### 2. Multi-Interface Support
hifi-wifi now detects and optimizes **ALL** active network interfaces simultaneously.
- **Scenario**: If you have both Ethernet and Wi-Fi connected, both will be optimized.
- **Benefit**: Seamless switching between networks without losing bufferbloat protection.

### 3. Simplified Architecture (No More Network Profiles)
- **Removed**: Network profile caching (`/var/lib/wifi_patch/networks/`)
- **Removed**: Tiered expiry system (30/90/180 day expiration logic)
- **Removed**: `--list-networks` CLI option
- **Why?** Since Link Statistics are instant, there's no need to cache bandwidth per-network. CAKE always gets the correct limit - no stale data possible.

## Bug Fixes
- **Fixed**: "Unable to turn off Power Save" ([#6](https://github.com/doughty247/hifi-wifi/issues/6)). Added explicit NetworkManager configuration (`99-hifi-wifi-powersave.conf`) to force disable Wi-Fi power saving.
- **Fixed**: Backend switching removed entirely ([#5](https://github.com/doughty247/hifi-wifi/issues/5)). hifi-wifi no longer touches your WiFi backend (iwd/wpa_supplicant).
    - SteamOS users: Use Developer Options → "Force WPA Supplicant WiFi backend"
    - Bazzite users: Use `ujust toggle-iwd` to switch backends
- **Fixed**: SteamOS - Version/Distro label now displays correctly (was showing OS version instead of hifi-wifi version).
- **Fixed**: SteamOS - Removed Wi-Fi network list that caused script to hang on long lists.
- **Fixed**: "unbound variable" error during apply.
- **Fixed**: Bandwidth limits being set to "0mbit" on very slow connections (now minimum 1mbit).
- **Fixed**: Aggressive cleanup in installer removes legacy backend configs.
- **Fixed**: Revert process now cleans up ALL possible backend config files.
- **Removed**: `--no-iwd` and `--use-iwd` flags (use OS tools instead).
- **Removed**: `--list-networks` CLI option (no longer needed).

## Technical Details
- **~370 lines of code removed** - simpler, more maintainable codebase
- **Dispatcher simplified**: Measures fresh link speed on every connection (instant)
- **Bandwidth calculation**: `Link Speed × 85%` (Wi-Fi) or `Link Speed × 95%` (Ethernet)

## Known Issues
- **Long Wi-Fi network list during install**: If you have many visible Wi-Fi networks, the installation may hang during the diagnostic output. **Workaround**: Press `Ctrl+C` to skip and continue. Fix planned for next release.

## How to Update
1. Update hifi-wifi: `git pull && ./install.sh`
2. Run `sudo hifi-wifi --apply` to apply the new optimizations.

**Note**: Old network profiles in `/var/lib/wifi_patch/networks/` can be safely deleted - they are no longer used.
