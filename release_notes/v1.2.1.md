# v1.2.1 - Critical WiFi Safety Fix

**CRITICAL HOTFIX** for users who lost Wi-Fi connectivity after installing hifi-wifi.

## The Problem (GitHub Issue #5)

hifi-wifi was **automatically switching to the iwd backend**, which:

1. **On SteamOS**: Conflicted with Developer Options "Force WPA Supplicant WiFi backend" toggle, causing a deadlock
2. **On Bazzite/other distros**: Broke systems with iwd-incompatible WiFi hardware (Broadcom, some Realtek, older Intel)

Even worse, the uninstall/revert process didn't fully clean up, leaving users "poisoned" with no way to restore connectivity.

## The Fix

### 1. Backend Switching Removed Entirely
hifi-wifi **no longer touches your WiFi backend**. Use your OS tools instead:

- **SteamOS**: Developer Options â†’ "Force WPA Supplicant WiFi backend" (iwd is default)
- **Bazzite**: Run `ujust toggle-iwd` to switch backends

The `--no-iwd` and `--use-iwd` flags have been removed. If iwd is already active on your system, hifi-wifi will still apply iwd-specific optimizations (roaming thresholds, scan settings).

### 2. Aggressive Cleanup (install.sh)
The installer now proactively removes any legacy backend configs before installation:
- Removes `*hifi*.conf` files from NetworkManager
- Removes `wifi_backend.conf` and `iwd.conf`
- Unmasks `wpa_supplicant.service` if previously masked

### 3. Thorough Revert (--revert)
The revert process now:
- Cleans up ALL possible backend config files (not just the one we created)
- Always unmasks wpa_supplicant
- Handles legacy file names from older versions

## Immediate Recovery (For Affected Users)

If you lost Wi-Fi after installing hifi-wifi, run these commands in Terminal:

```bash
# Remove conflicting configs
sudo rm /etc/NetworkManager/conf.d/*hifi*.conf 2>/dev/null
sudo rm /etc/NetworkManager/conf.d/wifi_backend.conf 2>/dev/null
sudo rm /etc/NetworkManager/conf.d/iwd.conf 2>/dev/null

# Unmask wpa_supplicant
sudo systemctl unmask wpa_supplicant.service

# Restart NetworkManager
sudo systemctl restart NetworkManager
```

Your Wi-Fi will return immediately.

## Files Changed
- `bin/hifi-wifi` - Removed `--use-iwd` and `--no-iwd` flags
- `src/lib.sh` - Version bump to 1.2.1
- `src/core.sh` - Removed iwd backend switching code, kept iwd optimization code
- `install.sh` - Proactive legacy config removal
- `README.md` - Updated documentation
